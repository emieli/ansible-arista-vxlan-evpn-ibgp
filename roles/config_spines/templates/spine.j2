vlan internal allocation policy ascending range 4000 4090
!
service routing protocols model multi-agent
!
hostname {{ inventory_hostname }}
!
spanning-tree mode mstp
!
no aaa root
!
{% for interface, values in interfaces.items() %}
interface {{ interface }}
   no switchport
   ip address {{ values.ipv4 }}
   ip ospf network point-to-point
   ip ospf area 0.0.0.0
!{% endfor %}
!
interface Loopback0
   ip address {{ router_id }}/32
   ip ospf area 0.0.0.0
!
interface Management1
   ip address dhcp
   no lldp receive
!
ip routing
!
router bgp {{ bgp.as }}
   router-id {{ router_id }}
   no bgp default ipv4-unicast
   maximum-paths 8 ecmp 8
   bgp listen range 10.0.255.0/24 peer-group LEAF remote-as {{ bgp.as }}
   neighbor LEAF peer-group
   neighbor LEAF remote-as {{ bgp.as }}
   neighbor LEAF update-source Loopback0
   neighbor LEAF route-reflector-client
   neighbor LEAF timers 10 30
   neighbor LEAF send-community extended
   neighbor LEAF maximum-routes 12000
   !
   address-family evpn
      neighbor LEAF activate
!
router ospf 1
   max-lsa 12000
!