all:
  children:
    SITE1:
      vars:
        site: SITE1
      children:
        spines:
          hosts:
            S1: 
              router_id: 10.255.255.1
              interfaces:
                Ethernet3: 
                  ipv4: 10.1.3.1/24
                Ethernet4: 
                  ipv4: 10.1.4.1/24
                Ethernet5: 
                  ipv4: 10.1.5.1/24
                Ethernet6: 
                  ipv4: 10.1.6.1/24
                Ethernet7: 
                  ipv4: 10.1.7.1/24
                Ethernet8: 
                  ipv4: 10.1.8.1/24
            S2:
              router_id: 10.255.255.2
              interfaces:
                Ethernet3:
                  ipv4: 10.2.3.2/24
                Ethernet4: 
                  ipv4: 10.2.4.2/24
                Ethernet5: 
                  ipv4: 10.2.5.2/24
                Ethernet6: 
                  ipv4: 10.2.6.2/24
                Ethernet7: 
                  ipv4: 10.2.7.2/24
                Ethernet8: 
                  ipv4: 10.2.8.2/24
        leafs:
          vars:
            vrfs:
              A:
                rd: "1:1"
              B:
                rd: "1:2"
            vlans: &vlans
              10:
                ipv4_virtual: 10.0.10.1/24
                vrf: A
              20:
                ipv4_virtual: 10.0.20.1/24
                vrf: A
              30:
                ipv4_virtual: 10.0.30.1/24
                vrf: B
              40:
                ipv4_virtual: 10.0.40.1/24
                vrf: B
          children:
            border_leafs:
              children:
                L1:
                  vars:
                    mlag_id: 10.255.0.1
                    vrfs:
                      A:
                        rd: "1:1"
                        bgp:
                          graceful_restart: True
                          neighbor:
                            172.31.0.1:
                              remote_as: 2
                      B:
                        rd: "1:2"
                        bgp:
                          graceful_restart: True
                          neighbor:
                            172.31.0.9:
                              remote_as: 2
                  hosts:
                    L1A-3:
                      router_id: 10.255.255.3
                      vlans:
                        <<: *vlans
                        3000:
                          ipv4: 172.31.0.2/29
                          vrf: A
                        3001:
                          ipv4: 172.31.0.10/29
                          vrf: A
                      interfaces:
                        Ethernet2:
                          ipv4: 10.1.3.3/24
                        Ethernet3:
                          ipv4: 10.2.3.3/24
                    L1B-4:
                      router_id: 10.255.255.4
                      vlans:
                        <<: *vlans
                        3000:
                          ipv4: 172.31.0.3/29
                          vrf: A
                        3001:
                          ipv4: 172.31.0.11/29
                          vrf: A
                      interfaces:
                        Ethernet2:
                          ipv4: 10.1.4.4/24
                        Ethernet3:
                          ipv4: 10.2.4.4/24
            internal_leafs:
              children:
                L2:
                  vars:
                    mlag_id: 10.255.0.2
                  hosts:
                    L2A-5:
                      router_id: 10.255.255.5
                      interfaces:
                        Ethernet2:
                          ipv4: 10.1.5.5/24
                        Ethernet3:
                          ipv4: 10.2.5.5/24
                    L2B-6:
                      router_id: 10.255.255.6
                      interfaces:
                        Ethernet2:
                          ipv4: 10.1.6.6/24
                        Ethernet3:
                          ipv4: 10.2.6.6/24
                L3:
                  vars:
                    mlag_id: 10.255.0.3
                  hosts:
                    L3A-7:
                      router_id: 10.255.255.7
                      interfaces:
                        Ethernet2:
                          ipv4: 10.1.7.7/24
                        Ethernet3:
                          ipv4: 10.2.7.7/24
                    L3B-8:
                      router_id: 10.255.255.8
                      interfaces:
                        Ethernet2:
                          ipv4: 10.1.8.8/24
                        Ethernet3:
                          ipv4: 10.2.8.8/24